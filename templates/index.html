{% extends "base.html" %}

{% block title %}Movie Recommendations - MovieRec{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <h1 class="display-4 fw-bold mb-4">
                    <i class="fas fa-magic me-3"></i>Discover Your Next Favorite Movie
                </h1>
                <p class="lead mb-4">
                    Get personalized movie recommendations using our advanced hybrid AI system that combines 
                    content-based and collaborative filtering techniques.
                </p>
                {% if not model_info.is_ready %}
                <div class="alert alert-warning" role="alert">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    Models not ready. Please run <code>python train.py</code> first.
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Personalized Rows for Logged-in Users -->
{% if current_user.is_authenticated and (country_movies or language_movies or genre_movies) %}
<section class="py-5 bg-light">
    <div class="container">
        {% if pref and pref.country and country_movies %}
        <div class="mb-5">
            <h4 class="mb-3"><i class="fas fa-globe-americas me-2"></i>Popular in {{ pref.country }}</h4>
            <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4">
                {% for m in country_movies %}
                <div class="col">
                    <div class="card movie-card h-100 position-relative">
                        <div class="score-badge">
                            <span class="badge bg-warning text-dark">⭐ {{ "%.1f"|format(m.rating or 0) }}</span>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title">{{ m.title }}</h6>
                            <div>
                                {% for g in (m.genre or '').split(',') %}
                                <span class="genre-tag">{{ g.strip() }}</span>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if pref and pref.language and language_movies %}
        <div class="mb-5">
            <h4 class="mb-3"><i class="fas fa-language me-2"></i>In {{ pref.language | upper }}</h4>
            <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4">
                {% for m in language_movies %}
                <div class="col">
                    <div class="card movie-card h-100 position-relative">
                        <div class="score-badge">
                            <span class="badge bg-warning text-dark">⭐ {{ "%.1f"|format(m.rating or 0) }}</span>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title">{{ m.title }}</h6>
                            <div>
                                {% for g in (m.genre or '').split(',') %}
                                <span class="genre-tag">{{ g.strip() }}</span>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if pref and pref.genre and genre_movies %}
        <div class="mb-5">
            <h4 class="mb-3"><i class="fas fa-tags me-2"></i>{{ pref.genre }} Picks</h4>
            <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4">
                {% for m in genre_movies %}
                <div class="col">
                    <div class="card movie-card h-100 position-relative">
                        <div class="score-badge">
                            <span class="badge bg-warning text-dark">⭐ {{ "%.1f"|format(m.rating or 0) }}</span>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title">{{ m.title }}</h6>
                            <div>
                                {% for g in (m.genre or '').split(',') %}
                                <span class="genre-tag">{{ g.strip() }}</span>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    
</section>
{% endif %}

<!-- Recommendation CTA removed per request; use top nav button -->

<!-- Features Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 mb-4">
                <div class="text-center">
                    <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                         style="width: 60px; height: 60px;">
                        <i class="fas fa-brain fa-lg"></i>
                    </div>
                    <h5>Hybrid AI System</h5>
                    <p class="text-muted">
                        Combines content-based filtering (TF-IDF) with collaborative filtering (SVD) 
                        for more accurate recommendations.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 mb-4">
                <div class="text-center">
                    <div class="bg-success text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                         style="width: 60px; height: 60px;">
                        <i class="fas fa-sliders-h fa-lg"></i>
                    </div>
                    <h5>Customizable Balance</h5>
                    <p class="text-muted">
                        Adjust the balance between content similarity and user preferences 
                        to fine-tune your recommendations.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 mb-4">
                <div class="text-center">
                    <div class="bg-info text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                         style="width: 60px; height: 60px;">
                        <i class="fas fa-chart-line fa-lg"></i>
                    </div>
                    <h5>Real-time Results</h5>
                    <p class="text-muted">
                        Get instant recommendations with detailed scoring and explanations 
                        for each suggested movie.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- API section removed per request -->
{% endblock %}

{% block extra_js %}
<script>
    // nothing for now
</script>
{% endblock %}
